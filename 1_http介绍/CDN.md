CDN 的最核心原则是“就近访问”.
“缓存代理”,使用“推”或者“拉”的手段，把源站的内容逐级缓存到网络的每一个节点上。

用户在上网的时候就不直接访问源站，而是访问离他“最近的”一个 CDN 节点， 缘节点”（edge node），其实就是缓存了源站内容的代理服务器，这样一来就省去了“长途跋涉”的时间成本，实现了“网络加速”。

在 CDN 领域里，“内容”其实就是 HTTP 协议里的“资源”，比如超文本、图片、视频、应用程序安装包等等。

只有静态资源才能够被缓存加速、就近访问；
动态资源只能由源站实时生成；


CDN 的负载均衡

全局负载均衡： 主要的职责是当用户接入网络的时候在 CDN 专网中挑选出一个“最佳”节点提供服务，解决的是用户如何找到“最近的”边缘节点。

实现方式：“DNS 负载均衡”。
权威 DNS 返回的不是 IP 地址，而是一个 CNAME( Canonical Name ) 别名记录，指向的就是 CDN 的 GSLB。

调度策略：

    1.看用户的 IP 地址，查表得知地理位置，找相对最近的边缘节点；
    2.看用户所在的运营商网络，找相同网络的边缘节点；
    3.检查边缘节点的负载情况，找负载较轻的节点；
    4.其他，比如节点的“健康状况”、服务能力、带宽、响应时间等。


CDN 的缓存代理

缓存系统只能有选择地缓存那些最常用的那些资源。

有两个 CDN 的关键概念：“命中”和“回源”。
“命中”就是指用户访问的资源恰好在缓存系统里，可以直接返回给用户；
“回源”则正相反，缓存里没有，必须用代理的方式回源站取。

提供命中率，降低回源率。
硬件方面：硬件用高速 CPU、大内存、万兆网卡，再搭配 TB 级别的硬盘和快速的 SSD。
软件方面：Redis、Ceph，尽可能地高效利用存储。



